// Contract configuration and ABI

// ✅ Mock contract (可在标准Sepolia上运行)
export const CIPHER_PUZZLE_LAB_ADDRESS = '0x362826cE7c0d18E9029d1E5F4Bf4C0894eE749f6' as const;

// Enums matching contract
export enum PuzzleStatus {
  Draft,
  Active,
  Paused,
  Ended,
  Revealed,
  Distributed
}

export enum DifficultyLevel {
  Beginner,
  Intermediate,
  Advanced,
  Expert,
  Master
}

export enum HintType {
  Range,
  Parity,
  Magnitude,
  Relationship
}

// Contract ABI - EnigmaVault (JSON format)
export const CIPHER_PUZZLE_LAB_ABI = [
  {
    "inputs": [],
    "stateMutability": "nonpayable",
    "type": "constructor"
  },
  {
    "anonymous": false,
    "inputs": [
      {
        "indexed": true,
        "internalType": "uint256",
        "name": "puzzleId",
        "type": "uint256"
      },
      {
        "indexed": false,
        "internalType": "string",
        "name": "title",
        "type": "string"
      },
      {
        "indexed": false,
        "internalType": "uint256",
        "name": "reward",
        "type": "uint256"
      }
    ],
    "name": "PuzzleCreated",
    "type": "event"
  },
  {
    "anonymous": false,
    "inputs": [
      {
        "indexed": true,
        "internalType": "uint256",
        "name": "puzzleId",
        "type": "uint256"
      },
      {
        "indexed": true,
        "internalType": "address",
        "name": "solver",
        "type": "address"
      }
    ],
    "name": "PuzzleSolved",
    "type": "event"
  },
  {
    "inputs": [
      {
        "internalType": "uint256",
        "name": "puzzleId",
        "type": "uint256"
      },
      {
        "internalType": "string",
        "name": "title",
        "type": "string"
      },
      {
        "internalType": "string",
        "name": "description",
        "type": "string"
      },
      {
        "internalType": "externalEuint32",
        "name": "encryptedAnswer",
        "type": "bytes32"
      },
      {
        "internalType": "bytes",
        "name": "inputProof",
        "type": "bytes"
      }
    ],
    "name": "createPuzzle",
    "outputs": [],
    "stateMutability": "payable",
    "type": "function"
  },
  {
    "inputs": [
      {
        "internalType": "address",
        "name": "player",
        "type": "address"
      }
    ],
    "name": "getPlayerPoints",
    "outputs": [
      {
        "internalType": "uint256",
        "name": "",
        "type": "uint256"
      }
    ],
    "stateMutability": "view",
    "type": "function"
  },
  {
    "inputs": [
      {
        "internalType": "uint256",
        "name": "puzzleId",
        "type": "uint256"
      }
    ],
    "name": "getPuzzle",
    "outputs": [
      {
        "internalType": "string",
        "name": "title",
        "type": "string"
      },
      {
        "internalType": "string",
        "name": "description",
        "type": "string"
      },
      {
        "internalType": "uint256",
        "name": "reward",
        "type": "uint256"
      },
      {
        "internalType": "address",
        "name": "creator",
        "type": "address"
      },
      {
        "internalType": "bool",
        "name": "isActive",
        "type": "bool"
      },
      {
        "internalType": "uint256",
        "name": "solvers",
        "type": "uint256"
      }
    ],
    "stateMutability": "view",
    "type": "function"
  },
  {
    "inputs": [
      {
        "internalType": "uint256",
        "name": "count",
        "type": "uint256"
      }
    ],
    "name": "getTopPlayers",
    "outputs": [
      {
        "internalType": "address[]",
        "name": "topAddresses",
        "type": "address[]"
      },
      {
        "internalType": "uint256[]",
        "name": "topScores",
        "type": "uint256[]"
      }
    ],
    "stateMutability": "view",
    "type": "function"
  },
  {
    "inputs": [],
    "name": "getTotalPlayers",
    "outputs": [
      {
        "internalType": "uint256",
        "name": "",
        "type": "uint256"
      }
    ],
    "stateMutability": "view",
    "type": "function"
  },
  {
    "inputs": [],
    "name": "owner",
    "outputs": [
      {
        "internalType": "address",
        "name": "",
        "type": "address"
      }
    ],
    "stateMutability": "view",
    "type": "function"
  },
  {
    "inputs": [
      {
        "internalType": "address",
        "name": "",
        "type": "address"
      }
    ],
    "name": "playerPoints",
    "outputs": [
      {
        "internalType": "uint256",
        "name": "",
        "type": "uint256"
      }
    ],
    "stateMutability": "view",
    "type": "function"
  },
  {
    "inputs": [
      {
        "internalType": "uint256",
        "name": "",
        "type": "uint256"
      }
    ],
    "name": "players",
    "outputs": [
      {
        "internalType": "address",
        "name": "",
        "type": "address"
      }
    ],
    "stateMutability": "view",
    "type": "function"
  },
  {
    "inputs": [
      {
        "internalType": "uint256",
        "name": "",
        "type": "uint256"
      }
    ],
    "name": "puzzles",
    "outputs": [
      {
        "internalType": "string",
        "name": "title",
        "type": "string"
      },
      {
        "internalType": "string",
        "name": "description",
        "type": "string"
      },
      {
        "internalType": "uint256",
        "name": "reward",
        "type": "uint256"
      },
      {
        "internalType": "address",
        "name": "creator",
        "type": "address"
      },
      {
        "internalType": "bool",
        "name": "isActive",
        "type": "bool"
      },
      {
        "internalType": "uint256",
        "name": "solvers",
        "type": "uint256"
      }
    ],
    "stateMutability": "view",
    "type": "function"
  },
  {
    "inputs": [
      {
        "internalType": "uint256",
        "name": "puzzleId",
        "type": "uint256"
      },
      {
        "internalType": "externalEuint32",
        "name": "encryptedAnswer",
        "type": "bytes32"
      },
      {
        "internalType": "bytes",
        "name": "inputProof",
        "type": "bytes"
      }
    ],
    "name": "submitSolution",
    "outputs": [],
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "inputs": [],
    "name": "totalPuzzles",
    "outputs": [
      {
        "internalType": "uint256",
        "name": "",
        "type": "uint256"
      }
    ],
    "stateMutability": "view",
    "type": "function"
  },
  {
    "inputs": [],
    "name": "totalSolvers",
    "outputs": [
      {
        "internalType": "uint256",
        "name": "",
        "type": "uint256"
      }
    ],
    "stateMutability": "view",
    "type": "function"
  }
] as const;

// TypeScript interfaces
export interface PuzzleInfo {
  creator: string;
  title: string;
  difficulty: DifficultyLevel;
  prizePool: bigint;
  deadline: bigint;
  status: PuzzleStatus;
  playerCount: number;
  totalAttempts: number;
  statusChangeCount: bigint;
}

export interface PlayerProfile {
  totalPuzzlesSolved: bigint;
  totalAttemptsUsed: bigint;
  totalPrizesWon: bigint;
  hintsUsedCount: bigint;
  firstPuzzleAt: bigint;
  lastPuzzleAt: bigint;
}

export interface GlobalStatistics {
  totalPuzzles: bigint;
  totalAttempts: bigint;
  totalPrizeDistributed: bigint;
}

export interface CreatePuzzleParams {
  puzzleId: bigint;
  title: string;
  description: string;
  solution: bigint;
  difficultyScore: number;
  difficulty: DifficultyLevel;
  durationInDays: number;
  maxAttempts: number;
  availableHints: number;
  prizePoolInEth: string;
}

export interface SubmitAttemptParams {
  puzzleId: bigint;
  answer: bigint;
  timeTakenInSeconds: number;
}

export interface PurchaseHintParams {
  puzzleId: bigint;
  hintType: HintType;
  hintValue: number;
  paymentInEth: string;
}
